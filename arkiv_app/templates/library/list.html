{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4 flex-column flex-sm-row gap-3">
  <h1 class="mb-0">Minhas Bibliotecas</h1>
  <a href="{{ url_for('library.create_library') }}" class="btn btn-accent"><i class="bi bi-plus-circle"></i> Criar nova biblioteca</a>
</div>
<form method="get" role="search" class="mb-4">
  <div class="input-group">
    <span class="input-group-text"><i class="bi bi-search"></i></span>
    <input type="search" class="form-control" name="q" value="{{ q }}" placeholder="Buscar biblioteca…" aria-label="Buscar biblioteca">
  </div>
</form>
{% if libraries %}
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
  {% for item in libraries %}
  {% set lib = item.instance %}
  <div class="col">
    <article class="card library-card h-100">
      <div class="library-card__title">
        <h5 class="mb-1"><a href="{{ url_for('library.show_library', lib_id=lib.id) }}">{{ lib.name }}</a></h5>
        <small>{{ item.asset_count }} imagens</small>
      </div>
      {% if lib.description %}<p class="text-muted small">{{ lib.description|truncate(100) }}</p>{% endif %}
      <div class="library-actions mt-auto">
        <a href="{{ url_for('library.edit_library', lib_id=lib.id) }}" class="btn-outline-accent">Editar</a>
        <form action="{{ url_for('library.delete_library', lib_id=lib.id) }}" method="post" onsubmit="return confirm('Remover biblioteca?');">
          <button type="submit" class="btn-delete">Deletar</button>
        </form>
      </div>
    </article>
  </div>
  {% endfor %}
</div>
{% else %}
<div class="text-center py-5">
  <p class="lead">Você ainda não criou nenhuma biblioteca. Comece agora!</p>
  <a href="{{ url_for('library.create_library') }}" class="btn btn-accent btn-lg"><i class="bi bi-plus-circle"></i> Criar primeira biblioteca</a>
</div>
{% endif %}
{% endblock %}

<header class="navbar-floating" aria-label="Barra de navegação principal">
  <span class="navbar-brand"><a href="{{ url_for('main.index') }}">Arkiv</a></span>
  {% if not login_page %}
  <div class="global-search">
    <form role="search" hx-get="/search" hx-trigger="keyup changed delay:300ms" hx-target="#content" hx-push-url="true">
      <input id="globalSearchInput" type="search" placeholder="Buscar..." name="q" aria-label="Buscar">
    </form>
  </div>
  {% endif %}
  <div class="navbar-actions">
    <div class="dropdown me-2">
      <button class="btn btn-link p-0" id="addMenu" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Adicionar">
        <i class="bi bi-plus-circle fs-4" aria-hidden="true"></i>
      </button>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="addMenu">
        <li><a class="dropdown-item" href="{{ url_for('library.create_library') }}">Nova Biblioteca</a></li>
        <li><a class="dropdown-item" href="{{ url_for('folder.create_folder') }}">Nova Pasta</a></li>
        <li><a class="dropdown-item" href="{{ url_for('library.list_libraries') }}">Novo Upload</a></li>
      </ul>
    </div>
    <button class="btn btn-link theme-toggle p-0" onclick="toggleTheme()" aria-label="Alternar tema" aria-pressed="false"><i class="bi bi-moon-fill" aria-hidden="true"></i></button>
    {% if current_user.is_authenticated %}
    {% set pending = pending_tasks if pending_tasks is defined else 0 %}
    <div class="avatar-frame position-relative" data-bs-toggle="modal" data-bs-target="#userModal">
      {% if pending %}<span class="avatar-badge">{{ pending }}</span>{% endif %}
      <img src="{{ url_for('static', filename='img/avatar.svg') }}" alt="{{ current_user.name }}" loading="lazy">
    </div>
    {% endif %}
  </div>
</header>

<div class="modal fade user-modal" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body text-center" id="userModalLabel">
        <a href="#" class="btn btn-accent">Configurações do Perfil</a>
      </div>
      <div class="modal-footer">
        <a href="{{ url_for('auth.logout') }}" class="btn btn-outline-danger btn-logout">Logout</a>
      </div>
    </div>
  </div>
</div>
